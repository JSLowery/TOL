<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- Saved on Friday, November 04, 2016, 7:29 PM -->
<!-- MuClient version 4.98 -->

<!-- Plugin "WhereMinwin" generated by Plugin Wizard -->
<muclient>
<plugin
   name="WhereMinwin"
   author="Sonet"
   id="5fd2a99f8168d2fc74f144eb"
   language="Lua"
   purpose="Displays people in the area"
   save_state="y"
   date_written="2016-11-04 19:27:25"
   requires="4.40"
   version="1.0"
   >
</plugin>


<!--  Get our standard constants -->
<include name="constants.lua"/>

<!--  Triggers  -->
<triggers>
  <trigger
   custom_colour="1"
   enabled="n"
   group="swho"
   match="^                       Who list sorted by \: Total Stats                     $"
   regexp="y"
   omit_from_output="y"
   sequence="100"
  >
  </trigger>
  <trigger
   custom_colour="1"
   enabled="n"
   group="swho"
   match="^\[(.*?)\] \[(.*?)\] (.*?)$"
   regexp="y"
   omit_from_output="y"
   script="swhoGrab"
   sequence="100"
  >
  </trigger>
  <trigger
   custom_colour="1"
   enabled="n"
   group="swho"
   match="^Players found\: \[(.*?)\]\, Max this reboot\: \[(.*?)\]\, Connections this reboot\: \[(.*?)\]$"
   regexp="y"
   omit_from_output="y"
   sequence="100"
  >
  </trigger>
  <trigger
   custom_colour="1"
   enabled="n"
   group="swho"
   match="^Players invis\: \[(.*?)\]\, Max on ever\: \[(.*?)\]$"
   regexp="y"
   omit_from_output="y"
   script="killswho"
   sequence="100"
  >
  </trigger>

<trigger
 match="^There are too many doors and fences to see who is in this area.$"
   regexp="y"
   send_to="12"
   sequence="1"
   group="gag_where"
    omit_from_output="y"
   script="killScript"
  >
  </trigger>
<trigger
   match="^Area created by : (.*)$"
   regexp="y"
   send_to="12"
   sequence="1"
   group="gag_where"
    omit_from_output="y"
  >
  </trigger>
  <trigger
   match="^Level range is  : (.*) to (.*)$"
   regexp="y"
   send_to="12"
   sequence="1"
   group="gag_where"
    omit_from_output="y"
  >
  </trigger>
  <trigger
   match="^You are in area\s+:\s+(.*)$"
   name="CurAreaminwin"
   regexp="y"
   send_to="12"
   sequence="1"
   omit_from_output="y"
   script="CurAreaminwin"
  >
  </trigger>
  <trigger
   match="^(?P<mob>[a-zA-Z]{3,12})\s{19,29}(?P<room>.+)$"
   
   name="DoSomething"
   regexp="y"
   send_to="12"
   sequence="1"
   omit_from_output="y"
   script="whereGrabber"
  >
  </trigger>
  <trigger
   match="^(.*?)$"
   name="KillSomething"
   regexp="y"
   send_to="12"
   sequence="2"
   omit_from_output="y"
   script="stopGrabbing"
  >
  </trigger>
  <trigger
   match="^Players near you\:$"
   regexp="y"
   send_to="12"
   sequence="100"
   omit_from_output="y"
   script="whereStarter"
   name="whereStarter"
  >
  </trigger>
  <trigger
   match="{begin running}"
   send_to="12"
   enabled="y"
   sequence="1"
   omit_from_output="n"
   script="stallScript"
   name="begrun"
  >
  
  </trigger>
  <trigger
   match="{end running}"
   send_to="12"
   enabled="y"
   sequence="1000"
   omit_from_output="n"
   script="allowScript"
   name="endrun"
  >
  </trigger>
</triggers>

<!--  Aliases  -->
<aliases>
  <alias
   name="where1"
   match="where1"
   enabled="y"
   send_to="12"
   sequence="100"
   script="startTheScript"
  >
  </alias>
  <alias
   name="toggleMap"
   match="map toggle"
   enabled="y"
   send_to="12"
   sequence="100"
   script="toggleTimer"
  >
  </alias>
  <alias
   match="^marks$"
   enabled="y"
   group="opk"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>require "pluginhelper" 
  res, gmcparg = CallPlugin("3e7dedbe37e44942dd46d264","gmcpval","char")
  luastmt = "gmcpdata = " .. gmcparg 
  assert (loadstring (luastmt or "")) ()
  level = tonumber(gmcpdata.status.level)
  Send("swho 12 opk " .. tonumber(level-10).." "..

tonumber(level+10))</send>

  </alias>
</aliases>

<!--  Timers  -->
<timers>
  <timer name="whtime" enabled="n" minute="0" second="15.00" offset_second="0.00"    send_to="12"
>
  <send>
  --print('timer whtime')
  sendWhere1()
   DebugNote("timer ")
   </send>

  </timer>
  <timer name="mapSend" enabled="n" minute="0" second="1.00" offset_second="0.00"    send_to="12">
  <send>
   
    res, gmcparg = CallPlugin("3e7dedbe37e44942dd46d264","gmcpval","char") 

    luastmt = "gmcpdata = " .. gmcparg 
    assert (loadstring (luastmt or "")) ()

    status = gmcpdata.status.state

    if status == '3' or status == '8' then
     SendNoEcho('map')
      if status == '3' then
       SetTimerOption('mapSend', 'second',1)

      end
      if status == '8' then
       SetTimerOption('mapSend', 'second', 2.5)

      end
    end
  </send>

  </timer>
</timers>

<script>
<![CDATA[
dofile (GetPluginInfo (GetPluginID (), 20) .. "whereminwin.lua")

phelper:set_default('cmd', 'mcp')
phelper:set_default('plugin_colour', 'steelblue')
phelper:add_pobject('win', whwin)
phelper:enable()
]]>
</script>
</muclient>